<!-- This html isinjected into the main page by $routeProvider, it is the only html template used -->
<md-content class="outer-content">
	<md-toolbar layout="row" layout-align="space-between center">
		<h2>Olin Trim Dining</h2>
		<div ng-switch="userAuthenticated">
			<div ng-switch-when="true" layout='row' layout-align='center center'>
				<md-button class="material-icons" ng-click="accountSettingsRedirect()">settings</md-button>
				<md-button ng-click="logout()">Logout</md-button>  		
			</div>
			<div ng-switch-when="false">
				<md-button ng-click="signupRedirect()">Sign Up</md-button> 
				<md-button ng-click="loginRedirect()">Login</md-button> 
			</div>
		</div>
	</md-toolbar>

	<div layout="column" layout-align="start" class="menu-content">
		<div layout="row" layout-align="center center" id="get-menu-form">
			<md-input-container>
		        <label>Dining Hall</label>
		        <md-select ng-model="formData.myLocation" placeholder="olin" ng-change="getDayMeals(formData)">
		          	<md-option value="olin">Olin</md-option>
		          	<md-option value="trim">Trim</md-option>
		        </md-select>
		    </md-input-container>
			<md-datepicker ng-model="formData.myDate" md-placeholder="Enter date" ng-change="getDayMeals(formData)"></md-datepicker>
			<md-button ng-click="setDateToday()">Today</md-button>
			<md-input-container>
				<label>Filter Foods</label>
				<md-select ng-model="formData.mySelectedFilters" ng-change="filterFoods()" multiple>
					<md-optgroup label="Dietary Types">
						<md-option ng-repeat="foodType in foodTypes" ng-value="foodType">{{foodType}}</md-option>
					</md-optgroup>
					<md-optgroup label="Allergens">
						<md-option ng-repeat="allergen in allergens" ng-value="allergen">{{allergen}}</md-option>
					</md-optgroup>
				</md-select>
			</md-input-container>
    	</div>
	    

	
		<div id="day-meal-list" layout='row' layout-aling="space-between stretch">
			<md-card flex class="meal-card" ng-repeat="meal in filteredDayMeals">
				<md-toolbar layout='row' layout-align="center center">
					<h4>{{mealTypeToDisplay[meal.mealType]}}</h4>
				</md-toolbar>
				
				<md-content class="meal-menu">
					<section ng-repeat="station in stations[meal.mealType]">
						<md-subheader class="md-primary">{{station}}</md-subheader>
						<md-list>
							<div ng-repeat="food in meal.foods">
								<md-list-item layout="column" ng-if="food.station === station">
									<div flex layout="row" layout-align="space-between center" class="dish-header">
										<div class='dish-text'>
											<h5 class='dish-name'>{{food.name}}</h5>
										</div>
										
										<div layout="row" class="food-buttons">
											<div class="notfavd-button" ng-if="userAuthenticated&&(userFavoriteFoods.indexOf(food._id) < 0)">
													<md-button class="material-icons" ng-click="addFav(food._id)">favorite_border</md-button>
											</div>
											<div class="isfavd-button" ng-if="userAuthenticated && userFavoriteFoods.indexOf(food._id) >= 0">
													<md-button class="material-icons" ng-click="rmFav(food._id)">favorite</md-button>
											</div>
											
											<div class="colapse-button" ng-if="!((food._id === currentlySelected.dish._id) && (meal.mealType === currentlySelected.meal))">
													<md-button  class="material-icons" ng-click="selectDish(meal, food)">keyboard_arrow_down</md-button>
											</div>
											<div class="expand-button" ng-if="((food._id === currentlySelected.dish._id) && (meal.mealType === currentlySelected.meal))">
													<md-button  class="material-icons" ng-click="unselectDish()">keyboard_arrow_up</md-button>
											</div>
										</div>
										
									</div>

									<div class="meal-content" ng-if="((food._id === currentlySelected.dish._id) && (meal.mealType === currentlySelected.meal))">
											<div layout="column" layout-fill class="expanded">
									            <section class="performance-facts">
													<header class="performance-facts__header">
														<h1 class="performance-facts__title">Nutrition Information</h1>
														<p>Serving Size: {{food.nutritionInformation[0].serving}}</p>
														<b><p>Allergens: {{food.nutritionInformation[0].allergens.join(', ')}}</p></b>
													</header>
													<table class="performance-facts__table">
														<thead>
															<tr>
																<th colspan="3" class="small-info">
																Amount Per Serving
																</th>
															</tr>
														</thead>
														<tbody>
															<tr>
																<th colspan="2">
																	<b>Calories</b> {{food.nutritionInformation[0].calories}}
																</th>
																<td>
																	Calories from Fat {{food.nutritionInformation[0].fatCalories}}
																</td>
															</tr>
															<tr class="thick-row">
																<td colspan="3" class="small-info">
																	<b>% Daily Value*</b>
																</td>
															</tr>
															<tr>
																<th colspan="2">
																	<b>Total Fat</b> {{food.nutritionInformation[0].fat}}g
																</th>
																	<td>
																	<b>{{food.nutritionInformation[0].fatPercent}}%</b>
																</td>
															</tr>
															<tr>
																<td class="blank-cell"></td>
																<th>Saturated Fat {{food.nutritionInformation[0].saturatedFat}}g</th>
																<td><b>{{food.nutritionInformation[0].saturatedFatPercent}}%</b></td>
															</tr>
															<tr>
																<td class="blank-cell"></td>
																<th>Trans Fat {{food.nutritionInformation[0].transFat}}g</th>
																<td></td>
															</tr>
															<tr>
																<th colspan="2"><b>Cholesterol</b> {{food.nutritionInformation[0].cholesterol}}mg</th>
																<td><b>18%</b></td>
															</tr>
															<tr>
																<th colspan="2"> <b>Sodium</b> {{food.nutritionInformation[0].sodium}}mg </th>
																<td><b>{{food.nutritionInformation[0].sodiumPercent}}%</b></td>
															</tr>
															<tr>
																<th colspan="2"> <b>Total Carbohydrate</b> {{food.nutritionInformation[0].carbohydrates}}g </th>
																<td><b>{{food.nutritionInformation[0].carbohydratesPercent}}%</b></td>
															</tr>
															<tr>
																<td class="blank-cell"> </td>
																<th> Dietary Fiber {{food.nutritionInformation[0].dietaryFiber}}g </th>
																<td> <b>{{food.nutritionInformation[0].dietaryFiberPercent}}%</b> </td>
															</tr>
															<tr>
																<td class="blank-cell"> </td>
																<th> Sugars {{food.nutritionInformation[0].sugar}}g </th>
																<td></td>
															</tr>
															<tr class="thick-end">
																<th colspan="2"> <b>Protein</b> {{food.nutritionInformation[0].protein}}g </th>
																<td></td>
															</tr>
														</tbody>
													</table>

													<table class="performance-facts__table--grid">
														<tbody>
															<tr>
																<td colspan="2"> Vitamin A {{food.nutritionInformation[0].vitAPercent}}% </td>
																<td> Vitamin C {{food.nutritionInformation[0].vitCPercent}}% </td>
															</tr>
															<tr class="thin-end">
																<td colspan="2"> Calcium {{food.nutritionInformation[0].calciumPercent}}% </td>
																<td> Iron {{food.nutritionInformation[0].ironPercent}}% </td>
															</tr>
														</tbody>
													</table>
													<p class="small-info">* Percent Daily Values are based on a 2,000 calorie diet. Your daily values may be higher or lower depending on your calorie needs:</p>
												</section>




									            <md-list class='nutritionInfo'>
									            	<md-list-item>
									            		{{food.nutritionInformation[0].description}}
									            	</md-list-item>
									            	<md-list-item>
									            		Nutrition Info
									            	</md-list-item>

									            	<md-list-item ng-repeat="(key,value) in food.nutritionInformation[0]">
									            		{{key}}: {{value}}
									            	</md-list-item>
									            </md-list>
								          </div>
									</div>
									<md-divider ng-if="!$last"></md-divider>

								</md-list-item>
							</div>
							
						</md-list>
					</section>
					
				</md-content>
			</md-card>
				
		</div>
</md-content>
